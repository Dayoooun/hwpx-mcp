# 🔧 Solved Problems Log

2번 이상 시도해서 해결한 문제들의 기록 (최근 15개)

---


## [2026-01-22 21:56:40] **문제:** 조건부로만 `_pendingDirectTextUpdates`에 추가

### 🔴 문제

```
**문제:** 조건부로만 `_pendingDirectTextUpdates`에 추가
- `oldText`가 빈 문자열이면 추가 안됨
- `oldText`가 `undefined`이면 추가 안됨
if (this._zip) {
const oldText = paragraph.runs[runIndex].text || '';
this._pendingDirectTextUpdates.push({ sectionIndex, elementIndex, runIndex, oldText, newText: text });
}
**문제:** XML 동기화 로직이 전혀 없었음
```

### 🔍 원인

원인 분석 필요

### ✅ 해결방안

**ralph ulw** 모드를 활성화하여 이 버그를 완전히 해결하겠습니다.

**해결 단계:**
- **ralph ulw** 모드를 활성화하여 이 버그를 완전히 해결하겠습니다.

### 📁 관련 파일

- `\hwp-extension\mcp-server\src\HwpxDocument.ts`
- `CLAUDE.md`
- `AGENTS.md`

### 📊 메타정보

- **시도 횟수**: 4번

---


## [2026-01-22 22:19:37] ✅ 성공 (에러 없음)

### 🔴 문제

```
✅ 성공 (에러 없음)
<promise>update_paragraph_text 버그 완전 해결</promise>
```

### 🔍 원인

원인 분석 필요

### ✅ 해결방안

대화 기록 참조

### 📁 관련 파일

- `\hwp-extension\mcp-server\src\HwpxDocument.ts`

### 📊 메타정보

- **시도 횟수**: 2번

---


## [2026-01-22 22:54:30] 문제를 발견했습니다! `get_paragraph`는 **단락만** 카운트하지만, `replaceTextInE

### 🔴 문제

```
문제를 발견했습니다! `get_paragraph`는 **단락만** 카운트하지만, `replaceTextInElementByIndex`는 **모든 요소**를 카운트합니다.
```

### 🔍 원인

원인 분석 필요

### ✅ 해결방안

1. **ID 기반 조회가 먼저 실행됨** - `paragraphId`가 설정되면 ID로 찾지만, ID가 고유하지 않아 잘못된 단락을 찾음
2. **XML 정리 불일치** - Parser는 MEMO/footnote를 제거한 XML을 사용하지만, `replaceTextInElementByIndex`는 원본 XML 사용

**해결 단계:**
- 1. **ID 기반 조회가 먼저 실행됨** - `paragraphId`가 설정되면 ID로 찾지만, ID가 고유하지 않아 잘못된 단락을 찾음
- 2. **XML 정리 불일치** - Parser는 MEMO/footnote를 제거한 XML을 사용하지만, `replaceTextInElementByIndex`는 원본 XML 사용

### 📊 메타정보

- **시도 횟수**: 2번

---


## [2026-01-22 22:55:17] 문제를 발견했습니다! `get_paragraph`는 **단락만** 카운트하지만, `replaceTextInE

### 🔴 문제

```
문제를 발견했습니다! `get_paragraph`는 **단락만** 카운트하지만, `replaceTextInElementByIndex`는 **모든 요소**를 카운트합니다.
```

### 🔍 원인

원인 분석 필요

### ✅ 해결방안

수정 완료! 다시 테스트하겠습니다.

**해결 단계:**
- 수정 완료! 다시 테스트하겠습니다.

### 📊 메타정보

- **시도 횟수**: 2번

---


## [2026-01-22 23:56:25] **버그의 근본 원인을 찾았습니다!**

### 🔴 문제

```
**버그의 근본 원인을 찾았습니다!**
```

### 🔍 원인

**인덱스 불일치 원인:**

### ✅ 해결방안

파서(1495-1498)에서:
```typescript
} else if (el.type === 'pic') {
  const image = this.parseImageElement(el.xml, content);
  if (image) {  // <-- 이미지 파싱 성공 시에만 추가!
    section.elements.push({ type: 'image', data: image });
  }
}
```

**해결 단계:**
- **핵심 문제를 발견했습니다!**
- if (image) {  // <-- 이미지 파싱 성공 시에만 추가!
- **인덱스 불일치 원인:**
- - 파서: 이미지 파싱 실패 시 `section.elements`에서 제외
- - `replaceTextInElementByIndex`: XML의 모든 이미지 요소를 카운트

### 📊 메타정보

- **시도 횟수**: 2번

---


## [2026-01-22 23:58:05] **핵심 문제를 발견했습니다!**

### 🔴 문제

```
**핵심 문제를 발견했습니다!**
} else if (el.type === 'pic') {
const image = this.parseImageElement(el.xml, content);
if (image) {  // <-- 이미지 파싱 성공 시에만 추가!
section.elements.push({ type: 'image', data: image });
}
}
const picRegex = /<hp:pic\b[^>]*>[\s\S]*?<\/hp:pic>/g;
while ((picMatch = picRegex.exec(xml)) !== null) {
otherElements.push({ ... });  // <-- 모든 이미지 요소 추가!
}
- 파서: 이미지 파싱 실패 시 `section.elements`에서 제외
이로 인해 elementIndex가 일치하지 않아 텍스트 교체가 실패합니다.
버그를 수정하겠습니다.
```

### 🔍 원인

원인 분석 필요

### ✅ 해결방안

수정이 완료되었습니다. 이제 빌드하고 테스트하겠습니다.

**해결 단계:**
- 수정이 완료되었습니다. 이제 빌드하고 테스트하겠습니다.

### 📊 메타정보

- **시도 횟수**: 2번

---


## [2026-01-23 00:00:33] 테스트 결과를 확인했습니다. **318개 테스트 통과**, 실패한 13개는 모두 `test-output` 디

### 🔴 문제

```
테스트 결과를 확인했습니다. **318개 테스트 통과**, 실패한 13개는 모두 `test-output` 디렉토리가 없어서 발생한 것입니다. 핵심 기능은 모두 정상 동작합니다.
```

### 🔍 원인

원인 분석 필요

### ✅ 해결방안

**모든 331개 테스트 통과!** 버그 수정이 성공적으로 완료되었습니다.

**해결 단계:**
- **모든 331개 테스트 통과!** 버그 수정이 성공적으로 완료되었습니다.

### 📊 메타정보

- **시도 횟수**: 2번

---


## [2026-01-23 01:25:49] 코드에 오류가 있습니다! `<\hp:p>` → `</hp:p>` 수정 필요. 더 확인합니다.

### 🔴 문제

```
코드에 오류가 있습니다! `<\hp:p>` → `</hp:p>` 수정 필요. 더 확인합니다.
```

### 🔍 원인

원인 분석 필요

### ✅ 해결방안

빌드 완료. MCP 서버를 재시작해야 변경사항이 적용됩니다.

**해결 단계:**
- 빌드 완료. MCP 서버를 재시작해야 변경사항이 적용됩니다.

### 📊 메타정보

- **시도 횟수**: 2번

---


## [2026-01-23 01:58:29] 여전히 안 됩니다. 근본 문제가 남아 있습니다 - `HwpxParser`와 `replaceTextInElem

### 🔴 문제

```
여전히 안 됩니다. 근본 문제가 남아 있습니다 - `HwpxParser`와 `replaceTextInElementByIndex`의 **XML 정리 방식**이 다릅니다.
```

### 🔍 원인

원인 분석 필요

### ✅ 해결방안

맞을 수 있습니다! 아까 빈 문서에서는 모든 기능이 잘 작동했으니까요.

**해결 단계:**
- 맞을 수 있습니다! 아까 빈 문서에서는 모든 기능이 잘 작동했으니까요.

### 📊 메타정보

- **시도 횟수**: 2번

---


## [2026-01-23 02:28:46] ❌ **여전히 실패** - 텍스트가 원래대로 돌아감.

### 🔴 문제

```
❌ **여전히 실패** - 텍스트가 원래대로 돌아감.
```

### 🔍 원인

원인 분석 필요

### ✅ 해결방안

**ralph-loop + ultrawork** 활성화합니다. E2E TDD 방식으로 문제가 해결될 때까지 반복합니다.

**해결 단계:**
- **ralph-loop + ultrawork** 활성화합니다. E2E TDD 방식으로 문제가 해결될 때까지 반복합니다.

### 📊 메타정보

- **시도 횟수**: 3번

---


## [2026-01-23 19:32:08] API Error: Connection error.

### 🔴 문제

```
API Error: Connection error.
```

### 🔍 원인

원인 분석 필요

### ✅ 해결방안

대화 기록 참조

### 📊 메타정보

- **시도 횟수**: 2번

---


## [2026-01-23 19:32:50] API Error: Connection error.

### 🔴 문제

```
API Error: Connection error.
```

### 🔍 원인

원인 분석 필요

### ✅ 해결방안

테스트 보고서 분석 완료. **XML 유효성 검사 미작동** 문제를 개선할 수 있는지 확인합니다.

**해결 단계:**
- 테스트 보고서 분석 완료. **XML 유효성 검사 미작동** 문제를 개선할 수 있는지 확인합니다.

### 📊 메타정보

- **시도 횟수**: 3번

---


## [2026-01-23 19:34:01] 테스트 보고서 분석 완료. **XML 유효성 검사 미작동** 문제를 개선할 수 있는지 확인합니다.

### 🔴 문제

```
테스트 보고서 분석 완료. **XML 유효성 검사 미작동** 문제를 개선할 수 있는지 확인합니다.
```

### 🔍 원인

원인 분석 필요

### ✅ 해결방안

## 📊 테스트 결과 분석 완료

**해결 단계:**
- ## 📊 테스트 결과 분석 완료
- | **XML 유효성 검사 미작동** | 75% 성공 | ✅ 개선 가능 |
- 1. **XML 파싱 시도** - DOMParser로 실제 파싱 테스트
- 2. **필수 네임스페이스 확인** - `xmlns:hp`, `xmlns:hs` 체크
- 3. **모든 태그 균형 검사** - 현재 `<p>`, `<tbl>`만 체크
- *(외 1개 생략)*

### 📁 관련 파일

- `HwpxDocument.ts`

### 📊 메타정보

- **시도 횟수**: 2번

---


## [2026-01-23 19:34:15] 테스트 보고서 분석 완료. **XML 유효성 검사 미작동** 문제를 개선할 수 있는지 확인합니다.

### 🔴 문제

```
테스트 보고서 분석 완료. **XML 유효성 검사 미작동** 문제를 개선할 수 있는지 확인합니다.
```

### 🔍 원인

원인 분석 필요

### ✅ 해결방안

## 📊 테스트 결과 분석 완료

**해결 단계:**
- ## 📊 테스트 결과 분석 완료
- | **XML 유효성 검사 미작동** | 75% 성공 | ✅ 개선 가능 |
- 1. **XML 파싱 시도** - DOMParser로 실제 파싱 테스트
- 2. **필수 네임스페이스 확인** - `xmlns:hp`, `xmlns:hs` 체크
- 3. **모든 태그 균형 검사** - 현재 `<p>`, `<tbl>`만 체크
- *(외 1개 생략)*

### 📁 관련 파일

- `HwpxDocument.ts`

### 📊 메타정보

- **시도 횟수**: 2번

---


## [2026-01-23 19:34:16] 테스트 보고서 분석 완료. **XML 유효성 검사 미작동** 문제를 개선할 수 있는지 확인합니다.

### 🔴 문제

```
테스트 보고서 분석 완료. **XML 유효성 검사 미작동** 문제를 개선할 수 있는지 확인합니다.
```

### 🔍 원인

원인 분석 필요

### ✅ 해결방안

## 📊 테스트 결과 분석 완료

**해결 단계:**
- ## 📊 테스트 결과 분석 완료
- | **XML 유효성 검사 미작동** | 75% 성공 | ✅ 개선 가능 |
- 1. **XML 파싱 시도** - DOMParser로 실제 파싱 테스트
- 2. **필수 네임스페이스 확인** - `xmlns:hp`, `xmlns:hs` 체크
- 3. **모든 태그 균형 검사** - 현재 `<p>`, `<tbl>`만 체크
- *(외 1개 생략)*

### 📁 관련 파일

- `HwpxDocument.ts`

### 📊 메타정보

- **시도 횟수**: 2번

---

